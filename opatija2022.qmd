---
title: "Analiza strukturnih promjena u sektorima međunarodno utrživih proizvoda i usluga"
author:
  - name: Prof. dr. sc. Josip Tica
    email: jtica@efzg.hr
    affiliations:
      - name: Ekonomski fakultet
        number: +385 1 2383 162
format: 
  docx:
    fig-width: 9
    fig-height: 10
execute:
  echo: false
  warning: false
crossref:
  fig-title: Grafikon   # (default is "Figure")
---

```{r}
#| warning: false

# install packages if not already installed
if (!is.element("DBI", installed.packages()[,1])) 
  install.packages("DBI", dep = TRUE)
if (!is.element("RMySQL", installed.packages()[,1])) 
  install.packages("RMySQL", dep = TRUE)
if (!is.element("data.table", installed.packages()[,1])) 
  install.packages("ggplot2", dep = TRUE)
if (!is.element("ggplot2", installed.packages()[,1])) 
  install.packages("ggplot2", dep = TRUE)
if (!is.element("patchwork", installed.packages()[,1])) 
  install.packages("patchwork", dep = TRUE)
if (!is.element("readxl", installed.packages()[,1])) 
  install.packages("readxl", dep = TRUE)
if (!is.element("ggrepel", installed.packages()[,1])) 
  install.packages("ggrepel", dep = TRUE)

# import packages
library(DBI)        # paket za povezivanje s bazom podataka
library(RMySQL)     # paket za povezivanje s RMySQL bazom podataka  
library(data.table) # data wrangling
library(dplyr)      # data wrangling
library(ggplot2)    # vizualizacija
library(patchwork)  # vizualizacija
library(ggrepel)    # vizualizacija
library(readxl)     # ucitavanje excel file-ova
```

```{r}
# pomocna funkcija za povezivanje s GFI MySQL bazom podataka
gfiConnect <- function() {
  db <- dbConnect(MySQL(), dbname = "odvjet12_gfi",
                  host = "91.234.46.219",
                  port = 3306L,
                  user = "odvjet12_mislav",
                  password = "Contentio0207")
  return(db)
}

# pomocna funkcija za slanje queya na GFI bazu podataka
gfiSelect <- function(query) {
  db <- gfiConnect()
  dbSendQuery(db, 'set character set "utf8"')
  dbSendQuery(db, 'SET NAMES utf8')
  data <- dbGetQuery(db, query)
  dbDisconnect(db)
  return(data)
}
```

```{r}
# preuzimanje podataka za sektor programiranja i turistički sektor
q <- sprintf("SELECT b335/1000000000 AS Export,
                     b370/1000000000 AS Import,
                     b372 AS Zaposleni,
                     b266/1000000000 AS Software,
                     b249/1000000000 AS Razvoj,
                     b250/1000000000 AS Tech, 
                     b004/1000000000 AS Razvoj1,
                     b005/1000000000 AS Tech1,
                     b003/1000000000 AS Nematerijalna,
                     b110/1000000000 AS Prihod,
                     b119/1000000000 AS Placa,
                     b147/1000000000 AS GrossProfit,
                     b151/1000000000 AS NetProfit,
                     b329/1000000000 AS Grants,
                     b123/1000000000 AS Amortizacija,
                     b150/1000000000 AS Porez,
                     (b003 + b010)/ 1000000000 AS MatNematmovina,
                     (b084 + b094)/ 1000000000 AS Dug,
                     (b136 - 130) / 1000000000 AS NetoFin,
                     reportyear, subjectid, employeecounteop, foreigncontrol,
                     nacerev21, nacerev22, nacerev23, nacerev24, countyid, 
                     municipalityid
                FROM gfi_all 
                WHERE reportyear >= 2000;")
gfi <- gfiSelect(q)       # preuzimanje podataka
gfi <- as.data.table(gfi) # koristenje data.table paketa za data.wangling
gfi$nacerev22 <- as.character(gfi$nacerev22)

# sifrarnici
nkd <- read.csv2("data/cb_reg_activity_translations.csv")
nkd <- nkd[, c("ActivityID", "ActivityName_.ENG.")]
opcine <- as.data.table(read_excel("data/OPCINE.xlsx"))
```

```{r}
# opatija tema za grafikone
theme_opatija <- function() {
  theme_minimal() %+replace% 
    theme(
      
      # legend
      legend.position = "bottom",
      legend.title = element_blank(),
      
      # x axis
      axis.title.x = element_blank(),
      axis.text = element_text(size = 11)
    )
}
```

## Sažetak

U ovom se radu analizira strukturna promjena proizvodnih sektora na agregatnoj razini Hrvatskog gospodarstva sa fokusom na tercijarizacijski proces u recentnom 20 godišnjem razdoblju (2001--2018). Istraživanje polazi od ekonomske teorije rasta i dugoročne strukturne promjene te empirijski istražuje unutar sektorsku dinamiku uslužnog sektora. Proces tercijarizacije definiran kao povećanje ekonomske aktivnosti uslužnog sektora u razvijenim zemljama i zemljama u razvoju empirijski je dobro dokumentiran u ekonomskoj literaturi. Tercijarizacijski proces je karakteristika dugoročne strukturne promjene u Hrvatskom gospodarstvu koja je započela 1970ih pri čemu se u razdoblju nakon 2000ih povećava unutarsektorska heterogenost te određeni podsektori uslužnog sektora dobivaju na važnosti. To je slučaj sa financijskim uslugama u prvom desetljeću i porastom važnosti računalnih usluga u drugom desetljeću 2000ih.U istraživanju se koriste disagregirani podaci na razini poduzeća iz godišnjih financijskih izvještaja poslovnih subjekata sa ciljem analize doprinosa sektorske u i unutarsektorske aktivnosti ekonomskim agregatima. Kvalitetni mikroekonomski podaci omogućuju detaljnu sektorsku analizu, uvažavajući čitav niz hetereogenosti. Rezultati istraživanja upućuju na važnost vertikalne industrijske politike u Hrvatskoj, koja je prekomjerno usmjerena na proizvodnji i turistički sektor kao perspektivne industrije, a nedovoljno uvažava sektor računalnog programiranja, koji zbog rastuće globalizacije i digitalizacije ima posebno važnu ulogu za budući ekonomski rast u Hrvatskoj.

## Uvod

Nakon 90-ih godina do danas tercijarizacija postaje dominantan čimbenik promjene u strukturi privrednih djelatnosti. Tercijarizacija označava strukturnu promjenu u gospodarstvu u kojoj uslužne djelatnosti povećavaju razmjernu važnost u agregatnoj strukturi gospodarstva. Iako predmet interdisciplinarnog interesa, tercijarizacijskim procesom se prvenstveno bavi ekonomska literatura koja potvrđuje kako moderni gospodarski razvoj podrazumijeva smanjenje udjela *outputa* primarnih i sekundarnih djelatnosti, odnosno da tercijarne djelatnosti apsorbiraju radnu snagu iz primarnih i sekundarnih djelatnosti, zapošljavajući je s većom proizvodnošću što rezultira rastom proizvodnog outputa i općenito, gospodarskim rastom i razvojem.

Ekonomska literatura naglašava brojne druge aspekte tercijarizacijskog procesa: relativno nižu produktivnost uslužnog sektora u odnosu na proizvodni (Krüger, 2008), postojanje značajnih unutarsektorskih razlika u tehnološkim kapacitetima, produktivnosti i obilježjima radne snage (Pillat and Wolf, 2005), važnost geografskih faktora (Herrendorf et al., 2014), značajne razlike u procesu tercijarizacije između razvijenih zemalja i zemalja u razvoju i dr. Upravo su specifičnosti procesa tercijarizacije u tranzicijskim i zemljama u razvoju te nedostatak istraživanja u domaćoj literaturi motivi za dublju analizu ovog procesa u Hrvatskoj. Te se specifičnosti odnose se na povijesne, institucionalne i političke karakteristike domaće ekonomije, tranzicijsko razdoblje obilježeno ratnim zbivanjima, zakašnjelo uključivanje u globalne financijske tokove, zakašnjelo pristupanje u EU i dr.

Osim pregleda strukture i dinamike na razini privrednih djelatnosti, ovo se istraživanje fokusira na dva uslužna podsektora - turizma i programiranja. Dok je turizam već dugo prepoznat kao strateška industrija s zahtijevanim visokim investicijama javnog sektora, programiranje tek nedavno dolazi u fokus ekonomske politike u RH. U radu se stoga istražuju pokazatelji produktivnosti, dodane vrijednosti, neto izvoza i profitabilnosti poslovanja na razini privrednih djelatnosti i u navedenim podsektorima uslužnih djelatnosti.

## Pregled literature

Gospodarski razvoj podrazumijeva smanjenje udjela primarnih (poljoprivrede, šumarstva, lova i ribolova te rudarstva) i sekundarnih (industrija i građevinarstvo) djelatnosti u formiranju nacionalnog proizvoda (Fisher, 1939.;Clark 1940;Rostow;1997). Nakon 1970ih, razvoj svjetskih privreda empirijski pokazuje da uslužne djelatnosti postaju dominantan sektor, kako u pogledu zaposlenosti tako i u doprinosu u BDP-u. Ekonomska teorija ističe četiri glavna objašnjenja povećanja relativne važnosti uslužnih djelatnosti u strukturi privrednih djelatnosti.

Prvo se objašnjenje (Baumol, 1967; Summers, 1985) odnosi na stranu ekonomske ponude. Uslijed porasta produktivnosti, proizvođački sektor smanjuje potrebe za radnom snagom, koja zbog toga prelazi u uslužni sektor. Time se povećavaju zaposlenost i drugi pokazatelji u tercijarnom sektoru pa on preuzima dominantnu ulogu u gospodarstvu. Drugo objašnjenje (Fisher, 1939; Clark, 1940; Fuchs, 1968; Schettkat, 2002) promatra potražnu stranu ekonomije. Zbog porasta agregatnog dohotka, preferencije potrošača pomiču se u smjeru proizvoda uslužnog sektora što povećava njegovu potražnju (outputom) i relativnu važnost u strukturi gospodarstva. Treće objašnjenje (Castells, 2000; Elfring, 1988; Singelmann, 1978) razmatra sektorsku strukturu uslužnih djelatnosti i analizira promjene u proizvodnim, distributivnim, javnim, informacijskim i drugim uslužnim podsektorima ističući da tehnologija, nove prilike i potrebe u društvu dovode do rasta tih podsektora što povećava pokazatelje relativne veličine uslužnog sektora i dovodi do njegova rasta. Četvrto se objašnjenje (Francois and Reinert, 1996; Pilat and Wölfl, 2005) zasniva na analizi sektorske strukture proizvođačkih i uslužnih djelatnosti u okviru input-output tablica. U okviru njega se znatan dio rasta uslužnog sektora može objasniti povećanim potrebama proizvodnog sektora za intermedijarnim uslužnim djelatnostima odnosno poslovnim uslugama, uglavnom povezanima s tehnološkim napretkom i povećanjem specifičnih potreba (npr. financijska intermedijacija, digitalni marketing) proizvođačkog sektora.

U novijoj se literaturi naglašava niz dodatnih aspekata procesa tercijarizacije odnosno deindustrijalizacije. Rowthorn i Couttus (2004) navode četiri glavna uzroka dindustrijalizacije u bogatim i razvijenim zemljama: podugovaranje (outsourcing) proizvodnje prerađivačkog sektora, pad proizvođačkih cijena, rast svjetske trgovine i rastući konkurentski pritisak te pad investicija koji više utječe na proizvođački sektor. Palma (2008) naglašava rast temeljen na prirodnim resursima (Dutch disease), podugovaranje u globalnom privrednom sistemu, tehnološki napredak i neintervencionističke ekonomske politike. Rodrik (2016) ističe liberalizaciju trgovinskih režima i ulazak Kine na globalno tržište. Felipe i dr. (2014) zauzimaju ponešto drugačiju poziciju i tvrde da se zaposlenost u proizvođačkom sektoru nije osjetno promijenila na globalnoj razini nego da je došlo do znatnih promjena u distribuciji i intenzitetu u pojedinim zemljama, uglavnom pod utjecajem globalizacije trgovine i ekonomske aktivnosti općenito.

Na empirijskoj strani analize tercijarizacijskog procesa je moguće identificirati tri (čvrste) stilizirane (empirijske) činjenice, pretežito potvrđene za bogate i razvijene zemlje: 1) povećanje udjela sektora usluga u ukupnoj dodatnoj vrijednosti i zaposlenosti, 2) glavnu ulogu u rastu uslužnog sektora imaju visokotehnološki podsektori uslužnih djelatnosti (financijske djelatnosti, informatičke djelatnosti, zdravstvo, obrazovne djelatnosti) dok sektori manjeg tehnološkog kapaciteta opadaju u važnosti, 3) postojanje rastuće premije na tehnološki specifične vještine proizvodnog faktora rada.

Prethodno navedena objašnjenja i stilizirane empirijske činjenice uglavnom se odnose na bogate i razvijene zemlje, no za njihovu valjanost u zemljama u razvoju i tranziciji, poput Hrvatske, znatno je manje dokaza (Rodrik, 2016) ili su uglavnom neistražena. Razlog su tomu specifičnosti povijesnog naslijeđa, institucionalne strukture (Hall i Soskice, 2001), stadiji razvoja u zemljama u razvoju i dr. Primjerice, ekspanzija proizvodnog sektora u tranzicijskoj zemlji može se razvijati paralelno sa sektorom usluga (Dasgupta i Singh, 2006), umjesto da mu prethodi – kako nalaže teorija. Pretpostavka o većoj produktivnosti i njezinu bržem rastu u uslužnom sektoru karakteristična je za visokotehnološke uslužne djelatnosti u razvijenim zemljama koje inoviraju samostalno i posjeduju odgovarajuću infrastrukturu za tehnološki napredak. S druge strane, zemlje u razvoju znatno više ovise o transferu tehnologije (tehnologiji koju nisu proizvele same). Nadalje, ova pretpostavka ne uzima u obzir postojanje značajnih unutarsektorskih razlika u distribuciji produktivnosti, a dodatno je suočena s problemima mjerenja produktivnosti u uslužnom sektoru. Također, valja napomenuti da su navedene pretpostavke izvedene u teorijskom okviru autarkične ekonomije i ne uzimaju obzir efekt potražnje za outputom proizvođačkog sektora na globalnim tržištima.

Dosadašnje analize tercijarizacijskog procesa, odnosno strukturne promjene u Hrvatskoj pokazuju da se ta tema uglavnom interdisciplinarno istraživala u okviru demografije, sociologije i ekonomije. Prema Wertheimer-Baletić (2017), hrvatsko društvo se nalazi u tzv. posttranzicijskoj etapi razvoja koju obilježavaju niske i uravnotežene stope rodnosti i smrtnosti na gotovo podjednakoj razini, a stopa prirodnog prirasta teži prema nuli. Jedna od zasigurno značajnijih posljedica demografske tranzicije jest starenje stanovništva (npr. Bara i Podgorelec, 2015; Nejašmić i Toskić, 2013) koje, između ostaloga, zahtjeva i nove obrasce zdravstvene i socijalne skrbi (Puljiz, 2000) te općenito potražnju za takvim tipom usluga koje pogoduju ulasku žena u radnoaktivni kontingent stanovništva (Akrap, 2011). Sve to zajedno utječe na povećanje potražnje za uslugama i uslužnim djelatnostima odnosno na proces tercijarizacije (koji također uključuje i djelatnosti kvartarnog i kvintarnog sektora). Sociološka istraživanja te procese promatraju u kontekstu promjena u socio-profesionalnoj strukturi (Peračković, 2010), odnosno obrazovnoj i ekonomskoj strukturi (Majetić, 2015) te u strukturi zaposlenosti i tržišta rada (Matković, 2003), dok ekonomska istraživanja (Gelo i Družić, 2016) tercijarizacijski proces analiziraju u okviru faktorske produktivnosti u privrednim sektorima.

Ovo će istraživanje, uz prethodno navedene, obuhvatiti i druge, dimenzije procesa tercijarizacije u Hrvatskoj za razdoblje od 2001. do 2019. godine u kontekstu izvozne konkurentnosti. Te dimenzije uključuju: analizu dodane vrijednosti i drugih pokazatelja proizvodnog outputa koja će pokazati glavne trendove procesa tercijarizacije; analizu produktivnosti koja pruža nove uvide u prirodu tehnološke promjene unutar uslužnog sektora; analizu kretanja zaposlenosti; analizu vanjskotrgovinske dinamike u strukturi gospodarskih djelatnosti kako bi se olakšalo razumijevanje relativne važnosti domaćeg i globalnog tržišta u procesu tercijarizacije; prostornu analizu procesa tercijarizacije prema geografskim odrednicama kako bi se bolje razumjelo prostorno rasprostiranje strukturne promjene. Istraživanje će tako omogućiti šire i složenije razumijevanje tercijarizacijskog procesa i strukturne promjene u Hrvatskoj. Takvi uvidi iznimno su važni za nositelje ekonomske politike ali i dublje razumijevanje tercijarizacijskog procesa.


## Podatci

Glavni izvor kvantitativnih sekundarnih podataka su: računovodstveno-financijski izvještaji (bilanca, račun dobiti i gubitka, procijenjeni izvještaj o novčanom toku) i dodatnih izvještaja (dodatni podaci financijskog izvještaja poduzetnika – obrazac POD-DOP), na godišnjoj razini na temelju kojih će se deskriptivno i statistički analizirati struktura i dinamika u sektorima privrednih djelatnosti. Godišnji izvještaji uključuju sva trgovačka društva (društva s ograničenom odgovornošću i dionička društva), obrte koji su po zakonu dužni izrađivati i predavati financijska izvješća mjerodavnim institucijama i zadružna poduzeća. Svi su financijski izvještaji nekonsolidirani.

U radu se koriste i računovodstveni pokazatelji: 
* Dodana vrijednost - računa se prema dohodovnom pristupu kao zbroj bruto dobiti, troškova osoblja, neto financijskih rashoda i amortizacije. 
* Neto marža - jednaka je omjeru neto dobiti i ukupnih prihoda. 
* Produktivnost - kao mjera produktivnosti koristi se produktivnost rada, koja se računa kao omjer ukupnih rashoda zaposlenih (bruto plaće i ostala davanja) i prosječnog broja zaposlenih prema satima rada.


## Struktura i dinamika ekonomske strukture

Strukturu gospodarstva na razini proizvodnih djelatnosti sačinjavaju sektori i podsektori:

1.  primarni sektor: A
2.  sekundarni sektor: B, C, D i E,
3.  tercijarni sektor: G, H, I i J,
4.  kvartarni sektor: K, L, M i N,
5.  kvintarni sektori O, P, Q, S i I.

Pri tome se kvartarni i kvintarni sektori smatraju djelom tercijarnog sektora.

## Prikaz na razini privrednih sektora

Udio pojedinog sektora u ukupnoj ekonomskoj strukturi može se analizirati na različite načine. U prvom dijelu analize, daje se prikaz na razini privrednih djelatnosti (5 sektora) 4 varijable: zaposlenost, ukupni prihodi, dodanu vrijednost i izvoz.

```{r}
# zupanije
geo1 <- unique(opcine[, .(ZUPANIJA, NAZIV_ZUP)]) 
geo2 <- unique(opcine[, .(OPCINA, NAZIV_OPC)])

# sektori po zupanijama
ekonomska_struktura <- gfi[, djelatnosti := fcase(
  nacerev21 == "A", "primarne",
  nacerev21 %in% c("B", "C", "D", "E", "F"), "sekundarne",
  nacerev21 %in% c("G", "H", "I", "J"), "tercijarne",
  nacerev21 %in% c("K", "L", "M", "N"), "kvartarne",
  nacerev21 %in% c("O", "P", "Q", "R", "S", "T"), "kvintarne"
)]
level_orders <- c("primarne", "sekundarne", "tercijarne", "kvartarne", "kvintarne")
ekonomska_struktura[, djelatnosti := factor(djelatnosti, levels = level_orders)]
zupanije <- ekonomska_struktura[reportyear == 2019]
zupanije <- zupanije[, .(n = n_distinct(subjectid), 
                         prihod = sum(Prihod, na.rm = TRUE),
                         izvoz = sum(Export, na.rm = TRUE),
                         uvoz = sum(Import, na.rm = TRUE),
                         rad = sum(employeecounteop, na.rm = TRUE),
                         trPlaca = sum(Placa, na.rm = TRUE),
                         amortizacija = sum(Amortizacija , na.rm = TRUE),
                         net_fin_prihodi = sum(NetoFin , na.rm = TRUE),
                         nett = sum(GrossProfit, na.rm = TRUE),
                         dug = sum(Dug, na.rm = TRUE),
                         imovina = sum(MatNematmovina, na.rm = TRUE)), 
                     by = .(djelatnosti, countyid, municipalityid)]
zupanije[, produktivnost_rada := (trPlaca / rad)]
zupanije[, dv := trPlaca + amortizacija + net_fin_prihodi + nett]
zupanije[, NetExport := izvoz - uvoz]
zupanije <- geo1[zupanije, on = c("ZUPANIJA" = "countyid")]
zupanije <- geo2[zupanije, on = c("OPCINA" = "municipalityid")]
zupanije <- zupanije[, .(djelatnosti, n, prihod, izvoz, uvoz, dv, NAZIV_ZUP, NAZIV_OPC)]
zupanije <- na.omit(zupanije)
```

```{r}
# prepare data for graph
struktura_rh <- na.omit(ekonomska_struktura[, .(reportyear, djelatnosti, Prihod,
                                                Placa, Amortizacija, 
                                                NetExport = Export -Import,
                                                NetoFin, GrossProfit, employeecounteop)])



# ekonomska struktura prihodi
struktura_rh_prihodi <- struktura_rh[, .(Prihodi = sum(Prihod)), 
                                     by = .(reportyear, djelatnosti)]
# struktura_rh_prihodi[reportyear == 2000, .(djelantosti = djelatnosti,
#                                                  Prihodi_pct = Prihodi / sum(Prihodi))]
# struktura_rh_prihodi[reportyear == 2019, .(djelantosti = djelatnosti,
#                                            Prihodi_pct = Prihodi / sum(Prihodi))]

g1 <- ggplot(struktura_rh_prihodi, 
                    aes(reportyear, Prihodi, fill = djelatnosti)) +
  geom_bar(stat = "identity") +
  scale_fill_grey(start = 0, end = 0.8) +
  labs(y = "Prihodi (mlrd. KN)") +
  theme_opatija()

# ekonomska struktura dv  
struktura_rh_dv <- copy(struktura_rh)
struktura_rh_dv[, dv := Placa + GrossProfit + Amortizacija + NetoFin]
struktura_rh_dv <- struktura_rh_dv[dv > -100] # remove outlier !
struktura_rh_dv <- struktura_rh_dv[, .(`Dodana vrijednost` = sum(dv)),
                                   by = .(reportyear, djelatnosti)]

test_1 <- struktura_rh_dv[reportyear == 2000, .(djelantosti = djelatnosti,
                                                 dv_pct = `Dodana vrijednost` / sum(`Dodana vrijednost`))]
test_2 <- struktura_rh_dv[reportyear == 2019, .(djelantosti = djelatnosti,
                                                 dv_pct = `Dodana vrijednost` / sum(`Dodana vrijednost`))]
# cbind(test_1, test_2)

g2 <- ggplot(struktura_rh_dv, aes(reportyear, `Dodana vrijednost`, 
                                  fill = djelatnosti)) +
  geom_bar(stat = "identity") +
  scale_fill_grey(start = 0, end = 0.8) +
  labs(y = "Dodana vrij. (mlrd. KN)") +
  theme_opatija()

# ekonomska struktura izvoz
struktura_rh_izvoz <- struktura_rh[, .(NetExport = sum(NetExport)), 
                                   by = .(reportyear, djelatnosti)]
test_1 <- struktura_rh_izvoz[reportyear == 2000, .(djelantosti = djelatnosti,
                                                 dv_pct = NetExport / sum(NetExport))]
test_2 <- struktura_rh_izvoz[reportyear == 2019, .(djelantosti = djelatnosti,
                                                 dv_pct = NetExport / sum(NetExport))]
# cbind(test_1, test_2)
g3 <- ggplot(struktura_rh_izvoz, aes(reportyear, NetExport, fill = djelatnosti)) +
  geom_bar(stat = "identity") +
  scale_fill_grey(start = 0, end = 0.8) +
  labs(y = "Neto izvoz (mlrd. KN)") +
  theme_opatija()

# ekonomska struktura zaposlenost
struktura_rh_zap <- struktura_rh[, .(Zaposlenost = sum(employeecounteop) / 1000),
                                 by = .(reportyear, djelatnosti)]
g4 <- ggplot(struktura_rh_zap, aes(reportyear, Zaposlenost, fill = djelatnosti)) +
  geom_bar(stat = "identity") +
  scale_fill_grey(start = 0, end = 0.8) +
  labs(y = "Zaposlenost (000)") +
  theme_opatija()

```

```{r}
#| label: fig-ekonomska-struktura
#| fig-cap: 'Ekonomska struktura u RH za razdoblje 2000-2019'

(g1 + g2) / (g3 + g4) + 
  plot_layout(guides = "collect") & theme(legend.position = 'bottom')
```

Kao kriteriji za analizu sektorskih udjela korišteni su: ukupni prihod, dodana vrijednost, zaposlenost i izvoz. Ako se kao kriterij koristi ukupni prihod, vidljivo je da u ekonomskoj strukturi najveći udio imaju sekundarni i tercijarni sektor. Slijedi kvartarni sektor, dok ostali (primarni i kvintarni) imaju vrlo niske udjele. Na početku razdoblja (2000.), najveći udio ima tercijarni sektor (47%) slijedi sekundarni sektor sa 43%, kvartarni sa 6%, primarni 3% i kvintarni 1%. Na kraju razdoblja (2019 godina), udjeli su sljedeći: tercijarni sektor čini 49% udjela, sekundarni 38% udjela kvartarni 8%, primarni 3% i kvintarni 2%. Moguće je zaključiti kako je u 20 godina tercijarni sektor blago povećao svoj udjel i postao najveći sektor po udjelu ukupnih prihoda u ukupnim prihodima svih djelatnosti. Drugi najveći je sekundarni sektor, ali ima sve manji udio kroz vrijeme. Kvartarni i kvintarni sektor rastu, dok primarni stagnira.

Raščlanjivanje ekonomske strukture po dodanoj vrijednosti prati sličnu dinamiku, ali pokazuje različite vrijednosti udjela. Na početku razdoblja prednjači sekundarni sektor sa 52% udjela, a slijede tercijarni sa 35% i kvartarni sa 10%. Na kraju razdoblja sekundarni sektor gubi na značaju i čini 38%, a tercijarni sektor ga prestiže i čini 40% udjela. Kvartarni dobiva na značenju i čini 14% udjela. Isto kao i kvintarni koji raste sa 1% na 4%. Ukratko, prema kriteriju dodane vrijednosti tercijarni sektor prestiže sekundarni i postaje dominantni sektor u RH. Sekundarni sektor gubi na veličini, ali još uvijek ima veliki udio.

Prema kriteriju zaposlenosti, nalazi su isti kao i kod dodane vrijednosti. Međutim, za varijablu neto izvoza su rezultati nešto drugačiji. Provo, postoji korelacija dinamike neto izvoza i dinamike trgovinske bilance na agregatnoj razini. Poslovni subjekti su ostvarivali negativan neto izvoz do otprilike 2009. godine, kada se trend promijenio. To je u skladu sa iskustvom Hrvatske prema makroekonomskim podacima. Drugo, postoji znatna razlika strukture neto izvoza po djelatnostima. Na početku razdoblja (2000. godina), svi sektori ostvaruju pozitivan neto izvoz. Nakon 2022. godine trend se okreće i sektori postaju neto uvoznici. Nakon velike financijske krize, sekundarni sektor postaje glavni generator pozitivnog neto izvoza, a tercijarni sektor glavni generator negativnog neto izvoza. Na kraju razdoblja, sekundarni sektor ostvaruje neto izvoz od 1.7 milijardi kuna, tercijarni sektor negativni neto izvoz od -1.5 milijardi kuna, kvartarni pozitivan neto izvoz od 0.63 milijardi kuna, primarni neto izvoz 0.08 milijardi kuna i kvintarni sektor neto izvoz od 0.04 milijardi kuna.

```{r}
#| label: fig-ekonomska-struktura-zup
#| fig-cap: 'Ekonomska struktura u RH po županijama za razdoblje 2000-2019'

# prihodi
g1 <- ggplot(zupanije, aes(x = NAZIV_ZUP, y = prihod, fill = djelatnosti)) +
  geom_bar(stat = "identity", position = "fill") +
  coord_flip() +
  scale_fill_grey(start = 0, end = 0.8) +
  theme_opatija() +
  theme(axis.title.y = element_blank(),
        axis.title.x = element_text(size = 10),
        axis.text.x = element_blank(),
        axis.text.y = element_text(size = 8)) +
  ylab("Udio u ukupnim prihodima")

# izvoz
g2 <- ggplot(zupanije, aes(x = NAZIV_ZUP, y = izvoz, fill = djelatnosti)) +
  geom_bar(stat = "identity", position = "fill") +
  coord_flip() +
  scale_fill_grey(start = 0, end = 0.8) +
  theme_opatija() +
  theme(axis.title.y = element_blank(),
        axis.title.x = element_text(size = 10),
        axis.text.y = element_text(size = 8)) +
  ylab("Udio u izvozu")

g1 / g2 + plot_layout(guides = "collect") & theme(legend.position = 'bottom')
```

Na grafikonu [-@fig-ekonomska-struktura-zup] je prikazana ekonomska struktura prema geografskim obilježjima. Budući da zaposlenost, ukupni prihodi i dodana vrijednost imaju sličnu dinamiku, razmatraju se dva pokazatelja - ukupni prihodi i izvoz. Grafikoni se odnose na prostornu raspodjelu vrijednosti po županijama u 2019. godini. Gornji grafikon prikazuje udio pojedinog sektora (primarni, sekundarni, tercijarni, kvartarni, kvintarni) u ekonomskoj strukturi za svaku županiju i upućuje na postojanje značajnih razlika po županijama. Na primjer, najveći udio tercijarnih djelatnosti prema ukupnom prihodu imaju zagrebačka i dubrovačko-neretvanska županija. Međimurska i osječko-baranjska imaju najveći udio sekundarnog sektora. Grafikon upućuje i na postojanje korelacije između udjela tercijarnog sektora i razvijenosti županije.

Donji dio slike prikazuje ekonomsku strukturu prema udjelu izvoza u svakom sektoru, u 2019. godini. Posebno valja primijetiti dubrovačko-neretvansku županiju u kojoj zbog velikog značaja turizma, tercijarni sektor ostvaruje 70% izvoza. Slična je interpretacija i za istarsku županiju. S druge strane, neke županije glavninu izvoza ostvaruju u sekundarnom sektoru poput virovitičko-podravske i vukovarsko-srijemske . Može se zaključiti da kod vanjskotrgovinske aktivnosti postoje jznačajne geografske razlike u strukturi privrednih djelatnosti.

## Prikaz na razini tercijarnog sektora

```{r}

# ekonomksa struktura za tercijarni sektor

ekonomska_struktura <- gfi[, djelatnosti := fcase(
  nacerev21 == "G", "Trgovina",
  nacerev21 == "H", "Prijevoz",
  nacerev21 == "I", "Smještaj i usluživanje hrane",
  nacerev21 == "J", "Informacije"
)]

# prepare data for graph
struktura_rh <- na.omit(ekonomska_struktura[, .(reportyear, djelatnosti, Prihod,
                                                NetExport = Export - Import, Placa, Amortizacija,
                                                NetoFin, GrossProfit, employeecounteop)])

# ekonomska struktura prihodi
struktura_rh_prihodi <- struktura_rh[, .(Prihodi = sum(Prihod)),
                                     by = .(reportyear, djelatnosti)]
# test_1 <-  struktura_rh_prihodi[reportyear == 2000, .(djelantosti = djelatnosti,
#                                                  Prihodi_pct = Prihodi / sum(Prihodi))]
# test_2 <- struktura_rh_prihodi[reportyear == 2019, .(djelantosti = djelatnosti,
#                                            Prihodi_pct = Prihodi / sum(Prihodi))]
# cbind(test_1 , test_2)

g1 <- ggplot(struktura_rh_prihodi,
                    aes(reportyear, Prihodi, fill = djelatnosti)) +
  geom_bar(stat = "identity") +
  scale_fill_grey(start = 0, end = 0.8) +
  labs(y = "Prihodi (mlrd. KN)") +
  theme_opatija()

# ekonomska struktura dv
struktura_rh_dv <- copy(struktura_rh)
struktura_rh_dv[, dv := Placa + GrossProfit + Amortizacija + NetoFin]
struktura_rh_dv <- struktura_rh_dv[dv > -100] # remove outlier !
struktura_rh_dv <- struktura_rh_dv[, .(`Dodana vrijednost` = sum(dv)),
                                   by = .(reportyear, djelatnosti)]
test_1 <- struktura_rh_dv[reportyear == 2000, .(djelantosti = djelatnosti,
                                                 dv_pct = `Dodana vrijednost` / sum(`Dodana vrijednost`))]
test_2 <- struktura_rh_dv[reportyear == 2019, .(djelantosti = djelatnosti,
                                                 dv_pct = `Dodana vrijednost` / sum(`Dodana vrijednost`))]
# cbind(test_1, test_2)

g2 <- ggplot(struktura_rh_dv, aes(reportyear, `Dodana vrijednost`,
                                  fill = djelatnosti)) +
  geom_bar(stat = "identity") +
  labs(y = "Dodana vrij. (mlrd. KN)") +
  scale_fill_grey(start = 0, end = 0.8) +
  theme_opatija()

# ekonomska struktura izvoz
struktura_rh_izvoz <- struktura_rh[, .(NetExport = sum(NetExport)),
                                   by = .(reportyear, djelatnosti)]
test_1 <- struktura_rh_izvoz[reportyear == 2000, .(djelantosti = djelatnosti,
                                                 dv_pct = NetExport / sum(NetExport))]
test_2 <- struktura_rh_izvoz[reportyear == 2019, .(djelantosti = djelatnosti,
                                                 dv_pct = NetExport / sum(NetExport))]
# cbind(test_1, test_2)

g3 <- ggplot(struktura_rh_izvoz, aes(reportyear, NetExport, fill = djelatnosti)) +
  geom_bar(stat = "identity") +
  scale_fill_grey(start = 0, end = 0.8) +
  labs(y = "Neto izvoz (mlrd. KN)") +
  theme_opatija()

# ekonomska struktura zaposlenost
struktura_rh_zap <- struktura_rh[, .(Zaposlenost = sum(employeecounteop) / 1000),
                                 by = .(reportyear, djelatnosti)]
g4 <- ggplot(struktura_rh_zap, aes(reportyear, Zaposlenost, fill = djelatnosti)) +
  geom_bar(stat = "identity") +
  scale_fill_grey(start = 0, end = 0.8) +
  labs(y = "Zaposlenost (000)") +
  theme_opatija()
```

```{r}
#| label: fig-struktura-tercijarni
#| fig-cap: 'Struktura tercijarnog sektora u RH za razdoblje 2000-2019'

(g1 + g2) / (g3 + g4) +
  plot_layout(guides = "collect") & theme(legend.position = 'bottom')
```

Dosadašnja analiza je potvrdila rastuću važnost tercijarnog sektora u ekonomskoj strukturi s jedne strane, te ukazala na vezu ekonomske razvijenosti pojedinih županije i udjela tercijarnog sektora s druge strane. Zbog važnosti tercijarnog sektora, u nastavku se detaljnije analizira njegova unutarsektorska struktura i dinamika. Prvo je prikazana ekonomska struktura tercijarnog sektora prema dodanoj vrijednosti, zaposlenosti, izvozu i ukupnom prohodu, a nakon toga su detaljnije analizirani podsektori turizma i programiranja.

Grafikon [-@fig-struktura-tercijarni] prikazuje unutarsektorsku dinamiku tercijarnog sektora. Prema svim varijablama, sektor trgovine čini najveći udio. Međutim, podatci pokazuju da ostali sektori poprimaju sve važniju ulogu. Prema udjelu dodane vrijednosti, u promatranom razdoblju sektor trgovine pada sa 75% dodane vrijednosti na 72%, sektor smještaja raste s 4% na 8%, dok ostali sektori ostaju nepromijenjeni. Prema kriteriju neto izvoza, trgovina čini konstanto generira negativan neto izvoz, dok sektori prijevoza i smještaja kontinuirano generiraju pozitivan neto izvoz. Sektor informacija čini vrlo mali udio u neto izvozu.

## Analiza ključnih izvoznih sektora

Prethodno prikazani podatci čine osnovu za detaljniju analizu strukture tercijarnog sektora, odnosno dva podsektora (druga NACEREV razina): turizma i programiranja i njegovu usporedbu sa prerađivačkim sektorom, kao najvećim sektorom prema NACEREV2007 djelatnostima. Turizam je ekonomska grana od strateškog značenja za RH. Ovdje valja istaknuti kako je prihode od turizma vrlo teško mjeriti jer postoje snažni efekti prelijevanja između turističkog i drugih sektora, a analizu dodatno otežava što znatan broj "malih" iznajmljivača ne predaje podatke o prihodima. U ovoj se analizi pod sektorom turizma podrazumijevaja sektor I - djelatnosti pružanja smještaja te pripreme i usluživanja hrane. Sektor programiranja nije grana od strateškog značenje za RH no pokazuje se kao izrazito bitan čimbenik domaćeg ekonomskog rasta. Sektor programiranja čine podsektori: 62 - Računalno programiranje, savjetovanje i djelatnosti povezane s njima i 63.1 - Obrada podataka, usluge poslužitelja i djelatnosti povezane s njima; internetski portali. Prerađivački sektor (NACEREV razina C) će se označavati kao "Industrija".


```{r}
# agregacija za sektor J i I data.table WAY
gfi_sample_turizam_prog <- gfi[, djelatnosti := fcase(
  nacerev21 == "I", "Turizam",
  nacerev22 == "62", "Programiranje",
  nacerev21 == "631", "Programiranje",
  nacerev21 == "C", "Industrija"
)]
gfi_sample_turizam_prog <- na.omit(gfi_sample_turizam_prog, cols = "djelatnosti")

# suiranje po sektoru
gfi_turizam_prog <- gfi_sample_turizam_prog[djelatnosti != "Industrija"]
gfi_turizam_prog <- gfi_sample_turizam_prog[, .(subjectid, reportyear, djelatnosti,
                                                Export, Import, Prihod, Placa, GrossProfit,
                                                Zaposleni, Grants, NetoFin, Porez,
                                                Amortizacija, NetProfit)]
gfi_turizam_prog <- gfi_turizam_prog[, lapply(.SD, sum),
                                     by = c("djelatnosti", "reportyear"),
                                     .SDcols = c("Export", "Import", "Prihod",
                                                 "Placa", "GrossProfit", "Zaposleni",
                                                 "Grants", "NetoFin", "Porez",
                                                 "Amortizacija", "NetProfit")]
setorderv(gfi_turizam_prog, c("djelatnosti", "reportyear"))

# racunanje varijabli
gfi_turizam_prog[, `:=`(
  DodanaVrijednost = Placa + GrossProfit + NetoFin + Amortizacija,
  NetoMarza = NetProfit / Prihod,
  IzvovPrihod = Export / Prihod,
  Produktivnost = (Placa * 1000000000) / Zaposleni,
  NetoIzvozPrihodi = (Export - Import) / Prihod,
  ProsjecnaPlaca = Placa * 1000000000 / Zaposleni,
  SRZaposleni = Zaposleni / shift(Zaposleni) - 1,
  NetExport = Export - Import
)]
gfi_turizam_prog[, DnvPrihodi := DodanaVrijednost / Prihod]
gfi_turizam_prog[, SRdv := DodanaVrijednost / shift(DodanaVrijednost) - 1]
```

```{r}
# prepare data for graph
struktura_rh <- na.omit(gfi_sample_turizam_prog[, .(reportyear, djelatnosti, Prihod,
                                                    NetExport = Export - Import, Placa, Amortizacija,
                                                    NetoFin, GrossProfit, employeecounteop)])
# struktura_rh <- struktura_rh[djelatnosti != "Industrija"]

# ekonomska struktura prihodi
struktura_rh_prihodi <- struktura_rh[, .(Prihodi = sum(Prihod)),
                                     by = .(reportyear, djelatnosti)]
test_1 <- struktura_rh_prihodi[reportyear == 2000, .(djelantosti = djelatnosti,
                                                 Prihodi_pct = Prihodi / sum(Prihodi))]
test_2 <- struktura_rh_prihodi[reportyear == 2019, .(djelantosti = djelatnosti,
                                           Prihodi_pct = Prihodi / sum(Prihodi))]
# cbind(test_1, test_2)

g1 <- ggplot(struktura_rh_prihodi,
             aes(reportyear, Prihodi, fill = djelatnosti)) +
  geom_bar(stat = "identity") +
  scale_fill_grey(start = 0, end = 0.8) +
  labs(y = "Prihodi (mlrd. KN)") +
  theme_opatija()

# ekonomska struktura dv
struktura_rh_dv <- copy(struktura_rh)
struktura_rh_dv[, dv := Placa + GrossProfit + Amortizacija + NetoFin]
struktura_rh_dv <- struktura_rh_dv[dv > -100] # remove outlier !
struktura_rh_dv <- struktura_rh_dv[, .(`Dodana vrijednost` = sum(dv)),
                                   by = .(reportyear, djelatnosti)]
test_1 <- struktura_rh_dv[reportyear == 2000, .(djelantosti = djelatnosti,
                                                 dv_pct = `Dodana vrijednost` / sum(`Dodana vrijednost`))]
test_2 <- struktura_rh_dv[reportyear == 2019, .(djelantosti = djelatnosti,
                                                 dv_pct = `Dodana vrijednost` / sum(`Dodana vrijednost`))]
# cbind(test_1, test_2)

g2 <- ggplot(struktura_rh_dv, aes(reportyear, `Dodana vrijednost`,
                                  fill = djelatnosti)) +
  geom_bar(stat = "identity") +
  scale_fill_grey(start = 0, end = 0.8) +
  labs(y = "Dodana vrij. (mlrd. KN)") +
  theme_opatija()

# ekonomska struktura izvoz
struktura_rh_izvoz <- struktura_rh[, .(NetExport = sum(NetExport)),
                                   by = .(reportyear, djelatnosti)]
test_1 <- struktura_rh_izvoz[reportyear == 2000, .(djelantosti = djelatnosti,
                                                 dv_pct = NetExport / sum(NetExport))]
test_2 <- struktura_rh_izvoz[reportyear == 2019, .(djelantosti = djelatnosti,
                                                 dv_pct = NetExport / sum(NetExport))]
# cbind(test_1, test_2)

g3 <- ggplot(struktura_rh_izvoz, aes(reportyear, NetExport, fill = djelatnosti)) +
  geom_bar(stat = "identity") +
  scale_fill_grey(start = 0, end = 0.8) +
  labs(y = "Neto izvoz (mlrd. KN)") +
  theme_opatija()

# ekonomska struktura zaposlenost
struktura_rh_zap <- struktura_rh[, .(Zaposlenost = sum(employeecounteop) / 1000),
                                 by = .(reportyear, djelatnosti)]
g4 <- ggplot(struktura_rh_zap, aes(reportyear, Zaposlenost, fill = djelatnosti)) +
  geom_bar(stat = "identity") +
  scale_fill_grey(start = 0, end = 0.8) +
  labs(y = "Zaposlenost (000)") +
  theme_opatija()
```

```{r}
#| label: fig-struktura-turizam-programiranje
#| fig-cap: 'Ekonomska struktura sektora turizma i programiranja u RH za razdoblje 2000-2019'

# ekonomska struktura programiranja i turizma
(g1 + g2) / (g3 + g4) +
  plot_layout(guides = "collect") & theme(legend.position = 'bottom')

```

Dinamika kretanja dodane vrijednosti, zaposlenosti, ukupnog prihoda i izvoza u (pod)sektorima industrije, turizma i programiranja prikazana je na grafikonu [-@fig-struktura-turizam-programiranje]. Industrija ostvaruje mnogo veće vrijednosti u odnosu na ostale sektore prema svim pokazateljima, ali se trendovi razlikuju. Postoji izražen trend relativno bržeg rasta programiranja, od ostala dva sektora. Primjerice, na početku razdoblja udio ukupnih prihoda između industrije, turizma i programiranja iznosio je 93%, 5% i 1%. Na kraju razdoblja iznosili su 80%, 13% i 5%. Dakle, raste značaj turizma i programiranja u odnosu na industriju, ako se gleda prema varijabli ukupnih prihoda. Ako pogledamo samo odnos turizma i programiranja, omjer je iznosio 20% programiranje, 80% turizam, dok je na kraju razdoblja odnos 30% - 70%. Programiranje dakle raste brže od turizma. Kod neto izvoza je dinamika drugačija. Industrija posljednjih 10-ak godina ostvaruje apsolutno najveće razine neto izvoza. Slijedi sektor turizma i potom sektor programiranja. Za razliku od sektora industrije, sektor turizma i programiranja ostvaruju stabilan i kontinuiran rast neto izvoza, bez velikih oscilacija (negativnog neto izvoza prije Velike recesije). Neto izvoz sektora turizma je rastao s 0.04 milijarde kuna u 2000. godini na 0.67 milijardi kuna u 2020. godini (15 puta). Sektor programiranja je rastao sa 0.005 milijardi kuna na 0.093 milijarde kuna (18 puta). Na početku razdoblja je neto izvoz turizma bio 8 puta veći, a na kraju razdoblja je 7.2 puta veći. Važno je primijetiti da sektor programiranja posebno brzo raste u posljednjih 5 promatranih godina.

```{r}
#| label: fig-struktura-dv-3s
#| fig-height: 7
#| fig-cap: 'Strutkura dodane vrijednosti za sektor turizma, sektor programiranja i prerađivački sektor u RH za razdoblje 2000-2019'

gfi_naverev_dv <- gfi_sample_turizam_prog[, lapply(.SD, sum),
                                         by = c("djelatnosti", "reportyear"),
                                         .SDcols = c("Placa", "GrossProfit", "NetoFin",
                                                     "Amortizacija")]
# setorderv(gfi_naverev_dv, c("djelatnosti", "reportyear"))
# gfi_naverev_dv[, `:=`(
#   DodanaVrijednost = Placa + Nett + NetoFin + Amortizacija
# )]
# gfi_naverev_dv[, djelatnosti := as.factor(djelatnosti)]

gfi_naverev_dv <- melt(gfi_naverev_dv, id.vars = c("reportyear", "djelatnosti"))
gfi_naverev_dv[, variable := fcase(variable == "Placa", "Plaća",
                                   variable == "GrossProfit", "Bruto Dobit",
                                   variable == "Amortizacija", "Amortizacija",
                                   variable == "NetoFin", "Neto fin. rashodi"
                                   )]
Encoding(gfi_naverev_dv$variable) <- "UTF-8"
# gfi_naverev_dv[djelatnosti == "Turizam" & reportyear == "2019", value / sum(value)]
# gfi_naverev_dv[djelatnosti == "Programiranje" & reportyear == "2019", value / sum(value)]
# gfi_naverev_dv[djelatnosti == "Industrija" & reportyear == "2019", value / sum(value)]

# graf
ggplot(gfi_naverev_dv,
       aes(x = reportyear, y = value, fill = variable)) +
  geom_bar(stat="identity") +
  facet_wrap(vars(djelatnosti), scales = "free") +
  scale_fill_grey(start = 0, end = 0.8) +
  labs(y = "Struktura dodne vrijednosti (mlrd. KN)") +
  theme_opatija()
```

Grafikon [-@fig-struktura-dv-3s] prikazuje strukturu dodane vrijednosti prema tipu dohotka koji generira dodanu vrijednost (bruto dobit, trošak osoblja, neto financijski rashodi, amortizacija). Važno je primjetiti da je zbog mnogo veće sume dodane vrijednosti za industriju svaka y os prikazana zasebno, a ne skupno za sve grafikone. Struktura dodane vrijednosti pokazuje da najveći udio u sva tri sektora ima trošak osoblja. Udio troškova osoblja je oko 55% dodane nove vrijednosti kod sektora turizma i industrije te oko 60% kod sektora programiranja. Kod industrije i turizma, po visini udjela slijedi amortizacija, koja čini cca 18% dodane vrijednosti kod industrije i cca 25% dodane vrijednosti kod turizma, dok je kod sektora programiranja udio amortizacije tek oko 8%. Bruto dobit pokazuje značajne oscilacije kod svih sektora. U sektoru programiranja bruto dobit čini 28% dodane vrijednosti, a kod turizma 15% na kraju razdoblja, što ukazuje na veću profitabilnost sektora programiranja u odnosu na sektor turizma i industrije. Zanimljivo je primijetiti i da je sektor turizma bilježio negativnu agregatnu bruto dobit nekoliko godina za redom, dok je kod sektora programiranja bruto dobit vrlo stabilna. Neto financijski rashodi su mali udio ukupne dodane vrijednosti.

Agregatne razine varijabli ne daju kompletan uvid u perspektivnost pojedinih (pod)sektora. Usporedba performansi zahtijeva upotrebu pokazatelja poslovanja, koji odražavaju količinu kvalitete ekonomskih procesa. Na sljedećim grafikonima su prikazani odabrani pokazatelji poslovanja sva tri sektora: ukupna suma dodane vrijednosti, ukupni broj zaposlenih, prosječna bruto plaća, ukupna suma poreza na dobit, udio dodane nove vrijednosti u ukupnim prihodima, neto marža, produktivnost i udio neto izvoza u prihodima. U nastavku slijedi intepretacija generiranih grafikona.

```{r}
# Udio izvoza u prihodu, neto marza
dt_performanse <- melt(gfi_turizam_prog, c("djelatnosti", "reportyear"),
                       measure.vars = c("ProsjecnaPlaca",
                                        "Zaposleni",
                                        "Porez",
                                        "DodanaVrijednost",
                                        "NetoMarza", 
                                        "Produktivnost",
                                        "NetoIzvozPrihodi",
                                        "DnvPrihodi"))
```

```{r}
#| label: fig-prosjecna-placa
#| fig-height: 7
#| fig-cap: 'Prosječna plaća za sektor turizma, sektor programiranja i prerađivački sektor u RH za razdoblje 2000-2019'

ggplot(dt_performanse[variable == "ProsjecnaPlaca"],
       aes(x = reportyear, y = value, linetype = djelatnosti)) +
  geom_line() +
  labs(x = "Godine", y = "Prosječna godišnja bruto plaća (KN)") +
  scale_linetype_manual(values=c("solid", "dotted", "longdash")) +
  theme_opatija()
```

Na grafu [-@fig-prosjecna-placa] je prikazana prosječna godišnja bruto plaća prema podacima iz godišnjih financijskih izvještaja. Prosječna plaća je računata kao odnos troškova osoblja i broja zaposlenih prema satima rada. Prosječna plaća ima pozitivan trend kod sva tri sektora, međutim sektor programiranja bilježi mnogo veće razine prosječnih bruto plaća. Prosječna plaća u sektoru programiranja je 80% veća od prosječne plaće u sektoru turizma (163 tisuće u odnosu na 91 tisuću kuna) te 72% veća od prosječne plaće od sektora industrije. Ove vrijednosti vrijede za 2019 godinu. Čak i uz ovako veliki jaz u prosječnim plaćama, sektor programiranja bilježi veće stope rasta prosječnih plaća od ostalih sektora.

```{r}
#| label: fig-sr-zaposlenost
#| fig-height: 7
#| fig-cap: 'Broj zaposlenih osoba prema satima rada za sektor turizma, sektor programiranja i prerađivački sektor u RH za razdoblje 2000-2019'

ggplot(dt_performanse[variable == "Zaposleni"],
       aes(x = reportyear, y = value / 1000, linetype = djelatnosti)) +
  geom_line() +
  labs(x = "Godine", y = "Broj zaposlenih (000)") +
  scale_linetype_manual(values=c("solid", "dotted", "longdash")) +
  theme_opatija()
```

Na grafu [-@fig-sr-zaposlenost] je prikazan ukupan broj zaposlenih tijekom promatrano razdoblja za sva tri sektora.Industrija zapošljava najviše osoba, slijedi turizam, pa programiranje. Međutim, osim ukupne suem, zanimljive su i stope rasta zaposlenosti. Industrija tijekom cijelog razdoblja bilježi rast zaposlenosti od 3%, turizam rast od 292%, a programiranje rast broj zaposlenih od čak 656%.

```{r}
#| label: fig-dv-3s
#| fig-height: 7
#| fig-cap: 'Stopa rasta zaposlenosti za sektor turizma, sektor programiranja i prerađivački sektor u RH za razdoblje 2000-2019'

ggplot(dt_performanse[variable == "DodanaVrijednost"],
       aes(x = reportyear, y = value, linetype = djelatnosti)) +
  geom_line() +
  labs(x = "Godine", y = "Dodana vrijednost (mlrd. KN)") +
  scale_linetype_manual(values=c("solid", "dotted", "longdash")) +
  theme_opatija()
```

Grafikon [-@fig-dv-3s] pokazuje dinamiku dodane vrijednosti. Iako je na prijašnjim grafikonima već analizirana struktura dodane vrijednosti, ovdje radi preglednosti pokazujemo ponovno sumu dodane vrijednosti. Zaključci su vrlo slični nalazima iz prethodnog grafa. Industrija ima najveću razinu dodane vrijednosti i rast u cijelom razdoblju od 209%. Po veličini slijedi turizam sa rastom od 658%, te programiranje sa najmanjom razinom dodane vrijednosti, ali rastom od 1.500%.

```{r}
#| label: fig-porez-3s
#| fig-height: 7
#| fig-cap: 'Porez na dobit za sektor turizma, sektor programiranja i prerađivački sektor u RH za razdoblje 2000-2019'

ggplot(dt_performanse[variable == "Porez"],
       aes(x = reportyear, y = value, linetype = djelatnosti)) +
  geom_line() +
  labs(x = "Godine", y = "Porez na dobit (mlrd. KN)") +
  scale_linetype_manual(values=c("solid", "dotted", "longdash")) +
  theme_opatija()
```

Grafikon [-@fig-porez-3s] prikazuje dinamiku poreza na dobit. Sektor turizma pokazuje značajne oscilacije. Prosjek je oko milijardu kuna godišnje. Sektor programiranja i turizma ostvaruju vrlo slične iznose poreza na dobit. Turizam pro kraju razdoblja ostvaruje nešto veće iznose poreza na dobit, što nije čudno s obzirom na mnogo veću razinu agregatnih prihoda.

```{r}
#| label: fig-nm-3s
#| fig-height: 7
#| fig-cap: 'Neto marža za sektor turizma, sektor programiranja i prerađivački sektor u RH za razdoblje 2000-2019'

ggplot(dt_performanse[variable == "NetoMarza"],
       aes(x = reportyear, y = value, linetype = djelatnosti)) +
  geom_line() +
  labs(x = "Godine", y = "Neto marža") +
  scale_linetype_manual(values=c("solid", "dotted", "longdash")) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
  theme_opatija()
```


Grafikon [-@fig-nm-3s] pokazuje dinamiku neto marže u promatranom razdoblju. Sektor programiranja konzistentno ostvaruje veće neto marže od od ostala dva sektora. Zanimljivo je primijetiti kako je turizam u polovici promatranog razdoblja ostvarivao negativne neto marže, a u prosjeku ostvaruje manje marže i od sektora industrije.

```{r}
#| label: fig-p-3s
#| fig-height: 7
#| fig-cap: 'Produktivnost za sektor turizma, sektor programiranja i prerađivački sektor u RH za razdoblje 2000-2019'

ggplot(dt_performanse[variable == "Produktivnost"],
       aes(x = reportyear, y = value, linetype = djelatnosti)) +
  geom_line() +
  labs(x = "Godine", y = "Produktivnost rada") +
  scale_linetype_manual(values=c("solid", "dotted", "longdash")) +
  theme_opatija()
```

Produktivnost se smatra temeljnim faktorom dugoročnog ekonomskog rasta, stoga je na grafikonu [-@fig-p-3s] prikazana dinamika produktivnosti za 3 promatrana sektora. Kao mjera produktivnosti korištena je produktivnost rada, odnosno omjer ukupnih rashoda zaposlenih (bruto plaće i ostala davanja) i prosječnog broja zaposlenih prema satima rada, na kraju razdoblja. Graf pokazuje da sektor programiranja ostvaruje znatno veću produktivnost od sektora turizma i industrije.

```{r}
#| label: fig-nip-3s
#| fig-height: 7
#| fig-cap: 'Omer neto izvoza i prihoda za sektor turizma, sektor programiranja i prerađivački sektor u RH za razdoblje 2000-2019'

ggplot(dt_performanse[variable == "NetoIzvozPrihodi"],
       aes(x = reportyear, y = value, linetype = djelatnosti)) +
  geom_line() +
  labs(x = "Godine", y = "Neto izvoz / prihod") +
  scale_linetype_manual(values=c("solid", "dotted", "longdash")) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
  theme_opatija()
```

Sljedeći grafikon ( [-@fig-nip-3s] ) pokazuje odnos neto izvoza i prihoda. Turizam ostvaruje veće udjele neto izvoza od sektora programiranja sve do 2015. godine ali i nakon 2016. godine. Trend pokazuje da programiranje ostvaruje sve bolje izvozne performanse, dok su neto izvozne performanse sektora turizma stabilne. Iako se izvozni potencijal ističe kao glavni faktor važnosti turizma, očito je da programiranje prema istom zaslužuje istu potporu iz javnih resursa. Sektor industrije bilježi u prosjeku slične iznose neto izvoza kao i programiranje.

```{r}
#| label: fig-dvp-3s
#| fig-height: 7
#| fig-cap: 'Omjer dodane vrijednosti i prihoda za sektor turizma, sektor programiranja i prerađivački sektor u RH za razdoblje 2000-2019'

ggplot(dt_performanse[variable == "DnvPrihodi"],
       aes(x = reportyear, y = value, linetype = djelatnosti)) +
  geom_line() +
  labs(x = "Godine", y = "Dodana vrijednost / prihod") +
  scale_linetype_manual(values=c("solid", "dotted", "longdash")) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
  theme_opatija()
```

Na grafikonu [@-fig-dvp-3s] je prikazano i kretanje agregatne dodane nove vrijednosti u odnosu na ukupne prihode za razdoblje 2001-2019. Sektor programiranja je bilježio veće vrijednosti između 2007. i 2015. godine, nakon čega veće vrijednosti bilježi turizam .Ukupno gledajući, može se reći da oba sektora u prosjeku ostvaruju podjednake razine dodane vrijednosti u odnosu na ukupne prihode, ali i da turizam pokazuje znatno veću volatilnost.SEktor industrije, s druge strane, ostvaruje znatno manje vrijednosti pokazatelja.

Analiza heterogenosti poslovnih subjekata iz pojedinih sektora može pružiti dodatan uvid o naravi promjena ekonomske strukture u RH. Stoga je tablici 1 prikazan pokazatelj heterogenosti u vidu koncentracije osnovnih varijabli. Koncentraciju je izračunata kao udio prihoda, izvoza, dodane vrijednosti i ukupnim prihoda za 99% i 95% poslovnih subjekata sa najvećim udjelom istih varijabli. Izračunuključuje za 2019. godinu, a provedena je za sektore programiranja, industrije i turizma.

```{r}
gfi_conc <- gfi_sample_turizam_prog[, .(subjectid, reportyear, djelatnosti, Export, Prihod,
                                        employeecounteop, DNV = Placa + GrossProfit + NetoFin + Amortizacija)]
gfi_conc_2019 <- gfi_conc[reportyear == 2019]
cols <- c("Export", "Prihod", "employeecounteop", "DNV")
cols_new <- paste0(cols, "_99")

# prihod
gfi_conc_2019_prihod_99 <- gfi_conc_2019[, sum(Prihod, na.rm = TRUE),
                                         by = .(djelatnosti, velik = Prihod > quantile(Prihod, 0.99))]
gfi_conc_2019_prihod_99[, tip := "prihod_99"]
gfi_conc_2019_prihod_95 <- gfi_conc_2019[, sum(Prihod, na.rm = TRUE),
                                         by = .(djelatnosti, velik = Prihod > quantile(Prihod, 0.95))]
gfi_conc_2019_prihod_95[, tip := "prihod_95"]

# DV
gfi_conc_2019_dv_99 <- gfi_conc_2019[, sum(DNV, na.rm = TRUE),
                                     by = .(djelatnosti, velik = DNV > quantile(DNV, 0.99))]
gfi_conc_2019_dv_99[, tip := "dv_99"]
gfi_conc_2019_dv_95 <- gfi_conc_2019[, sum(DNV, na.rm = TRUE),
                                     by = .(djelatnosti, velik = DNV > quantile(DNV, 0.95))]
gfi_conc_2019_dv_95[, tip := "dv_95"]

# izvoz
gfi_conc_2019_ex_99 <- gfi_conc_2019[, sum(Export, na.rm = TRUE),
                                     by = .(djelatnosti, velik = Export > quantile(Export, 0.99))]
gfi_conc_2019_ex_99[, tip := "ex_99"]
gfi_conc_2019_ex_95 <- gfi_conc_2019[, sum(Export, na.rm = TRUE),
                                     by = .(djelatnosti, velik = Export > quantile(Export, 0.95))]
gfi_conc_2019_ex_95[, tip := "ex_95"]

# zaposlenost
gfi_conc_2019_emp_99 <- gfi_conc_2019[, sum(employeecounteop, na.rm = TRUE),
                                     by = .(djelatnosti, velik = employeecounteop > quantile(employeecounteop, 0.99))]
gfi_conc_2019_emp_99[, tip := "emp_99"]
gfi_conc_2019_emp_95 <- gfi_conc_2019[, sum(employeecounteop, na.rm = TRUE),
                                     by = .(djelatnosti, velik = employeecounteop > quantile(employeecounteop, 0.95))]
gfi_conc_2019_emp_95[, tip := "emp_95"]

# koncetracija
concetration <- rbind(gfi_conc_2019_prihod_99, gfi_conc_2019_prihod_95,
                      gfi_conc_2019_dv_99,gfi_conc_2019_dv_95,
                      gfi_conc_2019_emp_99, gfi_conc_2019_emp_95,
                      gfi_conc_2019_ex_99, gfi_conc_2019_ex_95)
setorder(concetration, djelatnosti)
setnames(concetration, "V1", "udio")
concetration[, udio := round(udio / sum(udio) * 100, 2), by = .(djelatnosti, tip)]
concetration[, velik := fcase(velik, "velik", !velik, "mali")]

# tablica
# concetration[, Kriterij := paste0(tip, "_", velik)]
tbl_ <- dcast(concetration, formula = djelatnosti ~ tip + velik, value.var = "udio", fun = sum)
cols <- colnames(tbl_)[grep("mali", colnames(tbl_))]
tbl_ <- tbl_[, .SD, .SDcols = !cols]
colnames(tbl_ ) <- c("Djelatnost", "DV 95pct", "DV 99pct",
                     "ZAP 95pct", "ZAP 99pct", "IZVOZ 95pct",
                     "IZVOZ 99pct", "PRIHOD 95pct", "PRIHOD 99pct")

kableExtra::kable(tbl_)
```

Prema pokazatelju dodane vrijednosti, industrija i turizam imaju sličan pokazatelj koncentracije: oko 1% najvećih poduzeća po dodanoj vrijednosti generira oko 57% dodane vrijednosti. Kod programiranjaje je udio mnogo manji (32%). Ako se gleda 5% poslovinh subjekta koji generiraju najveću dodanu vrijednost, najveću koncetraciju pokazuje industrija, potom turizam i na kraju programiranje. 

Kod zaposlenosti i ukupnih prihoda postoji isti obrzac. Industrija pokazuje najveći stupanj koncetracije, slijedi turizam, pa programiranje. Izvoz općenito pokazuje najveći stupanj koncetracije kod svih djelatnosti. Kod turizma, 1% poduzeća koje najviše izvoze generiraju 83% ukupnog izvoza, dok je kod programiranja taj broj 33%, a kod industrije 80%. Ako se gleda 5% poduzeća koje najviše izvoze, kod turizma je ta brojka 99%, a kod programiranja 82%. Može se zaključiti da sektor programiranja karakterizira niži stupanj koncetracije, odnosno veći stupanj unutarsektorske konkurentnosti.

## Zaključak

## Literatura

Akrap, A. (2011). Sektor zaposlenosti žena i fertilitet u Hrvatskoj. Društvena istraživanja, 20(1): 3–23. https://doi.org/10.5559/di.20.1.01.
Bara, M.; Podgorelac, S. (2015). Društvene teorije umirovljenja i produktivnog starenja. Etnološka tribina: Godišnjak Hrvatskog etnološkog društva, 45 (38): 58–71. https://doi.org/10.15378/1848-9540.2015.38.02
Baumol, W. J. (1967). MacroEconomics of Unbalanced Growth-The Anatomy of Urban Cities. American Economic Review. 57.
Castells, M. (2000). Uspon umreženog društva, Zagreb, Golden Marketing.
Clark, C. (1957). The Conditions of Economic Progress, London, Macmilan.
Dasgupta, Sukti; Singh, Ajit (2006). Manufacturing, Services and Premature Deindustrialization in Developing Countries: A Kaldorian Analysis. Research Paper 2006/49. Helsinki: UNU-WIDER.
Elfring, T. (1988). Service Employment in Advanced Economies. A Comparative Analysis of Its Implications for Economic Growth. Groningen: Rijksuniversiteit Groningen.
Felipe, J.; Mehta, A.; Rhee, C. (2014). “Manufacturing Matters... But It’s the Jobs that Count”, Asian Development Bank Economics Working Paper Series, (420), doi: 10.2139/ssrn.2558904.
Fisher, I. (1939). Production, primary, secondary and tertiary, Economic Record 15, June, 24-38. 
Francois, Joseph; Reinert, Kenneth. (1995). The Role of Services in the Structure of Production and Trade: Stylized Facts from a Cross-Country Analysis. Asia-Pacific, Economic Review. (2).
Fuchs, V. R. (1968). The Service Economy, New York: National Bureau of Economic Research
Gelo, T. i Družić, M. 2016. ‘Sektorska struktura gospodarstva Hrvatske’. U Gospodarstvo Hrvatske, A. Obadić i J. Tica (ur.). Zagreb: Ekonomski fakultet Sveučilišta u Zagrebu
Hall, Peter A.; Soskice, David (2001). Varieties of Capitalism: The Institutional Foundations of Comparative Advantage. Oxford: Oxford University Press.
Herrendorf, B.; Rogerson, R; Valentinyi, A. (2014). Growth and structural transformation. In: Aghion, P., Durlauf, S. N. (Eds.), Handbook of Economic Growth. Elsevier.
Krüger, J. J. (2008). Productivity and structural change: a review of the literature. J. Econ. Surv. 22 (2), 330–363.
Majetić, Filip (2015). Zagreb u postindustrijsko doba. Zagreb: Institut društvenih znanosti Ivo Pilar. 
Matković, T. (2003). Restrukturiranje rada? Transformacija strukture zaposlenosti. Revija za socijalnu politiku, 10(2), 161-184. DOI: 10.3935/rsp.v10i2.125
Nejašmić, I.; Toskić, A. (2013). Starenje stanovništva u Hrvatskoj – sadašnje stanje i perspektive. Hrvtaski geografski glasnik, 75 (1), 89 –110.
Peračković, K. (2010). (Za)što raditi u postindustrijskom društvu? – Promjene u društvenoj podjeli rada na početku 21. stoljeća, Zagreb, Alinea i Institut društvenih znanosti «Ivo Pilar».
Pilat , D.; Wölfl, A. (2005). Measuring the Interaction Between Manufacturing and Services. OECD, Paris (Working Paper, 2005/5).
Pilat, Dirk & Woelfl, Anita. (2005). Measuring the Interaction Between Manufacturing and Services. SSRN Electronic Journal. 10.2139/ssrn.1690954. 
Puljiz, V. (2000). Starenje stanovništva Europe. Dokumentacija. Revija za socijalnu politiku, 7 (1), 109-112. http://dx.doi.org/10.3935/rsp.v7i1.278
Rodrik,Dani 2016. "Premature deindustrialization," Journal of Economic Growth, Springer, vol. 21(1), pages 1-33, March. 
Rostow, W. W. (1997). The Stages of Economic Growth: A Non-Communist manifesto, Cambridge, University Press.
Rowthorn, Robert and Coutts, Kenneth, (2004), De-industrialisation and the balance of payments in advanced economies, Cambridge Journal of Economics, 28, issue 5, p. 767-790.
Schettkat, R. (2002). The Two Blades of the Scissors: The Interaction Between Demand and Supply in Market Economies. (Manuscript).
Singelmann, J. (1978). From Agriculture to Services. The Transformation of Industrial Employment. Beverly Hills: Sage Publications.
Summers, R. (1985). ‘Services in the International Economy’. In: Inman, R.P (ed.) Managing the Service Economy. Cambridge: CUP. pp. 27–48.
Wertheimer-Baletić, A., 2017. Demografska teorija, razvoj stanovništva Hrvatske i populacijska politika (izabrana djela). Samobor: Meridijani.

